<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchase Return Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="purchaseReturn.css">
</head>
<body>

    <div class="container-fluid mt-3">
        <div id="purchaseFormContainer" class="p-4 border rounded shadow-sm bg-light">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <button type="button" class="btn btn-outline-secondary" id="backToDashboardButtonPurchase">
                    <i class="bi bi-arrow-left-circle"></i> Back to Dashboard
                </button>
                <h2 class="text-center flex-grow-1 fw-bold text-primary">Purchase Return Form</h2>
                <button type="button" class="btn btn-outline-info " id="purchaseListButton">
                    <i class="bi bi-list-columns-reverse"></i> View List
                </button>
            </div>

            <div class="purchase-return-form-wrapper">
                <form id="mainPurchaseForm">
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="purchaseDate" class="form-label">Date</label>
                            <input type="date" class="form-control" id="purchaseDate">
                        </div>
                        <div class="col-md-4">
                            <label for="purchaseInvoiceNo" class="form-label">Invoice No.</label>
                            <input type="text" class="form-control" id="purchaseInvoiceNo" readonly tabindex="-1">
                        </div>
                        <div class="col-md-4">
                            <label for="purchaseOrderNo" class="form-label">Purchase Order No.</label>
                            <input type="text" class="form-control" id="purchaseOrderNo" placeholder="Enter purchase order number">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="purchaseDescription" class="form-label">Description</label>
                            <input type="text" class="form-control" id="purchaseDescription" placeholder="Enter purchase description">
                        </div>
                        <div class="col-md-6">
                            <label for="purchaseAttachment" class="form-label">Attachment</label>
                            <input type="file" class="form-control" id="purchaseAttachment">
                        </div>
                    </div>

                    <fieldset class="border p-3 mb-3 rounded">
                        <legend class="float-none w-auto px-2 fw-bold">Vendor Details</legend>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="supplierCode" class="form-label">VendorCode</label>
                                <select class="form-select" id="supplierCode">
                                    <option selected>S001</option>
                                    <option>S002</option>
                                    <option>S003</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="supplierName" class="form-label">Vendor Name</label>
                                <select class="form-select" id="supplierName">
                                    <option selected>Select name</option>
                                    <option >ABC Supplies</option>
                                    <option>XYZ Distributors</option>
                                    <option>Best Vendors Inc.</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="supplierAddress" class="form-label">Address</label>
                                <input type="text" class="form-control" id="supplierAddress" >
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="supplierTelephone" class="form-label">Telephone</label>
                                <input type="tel" class="form-control" id="supplierTelephone">
                            </div>
                            <div class="col-md-4">
                                <label for="purchaseTermsOfPayment" class="form-label">Terms of Payment</label>
                                <div class="input-group">
                                    <select class="form-select" id="purchaseTermsOfPayment">
                                        <option selected>Cash</option>
                                        <option>Net 30</option>
                                        <option>Net 60</option>
                                    </select>
                                    <button type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#termsModalPurchase">
                                        <i class="bi bi-plus-circle"></i> Add New
                                    </button>
                                </div>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset class="border p-3 mb-3 rounded">
                        <legend class="float-none w-auto px-2 fw-bold">Purchase Items</legend>
                        <div class="table-responsive">
                            <table class="table table-bordered table-sm" id="purchaseItemsTable">
                                <thead>
                                    <tr>
                                        <th>Item Code</th>
                                        <th>Description</th>
                                        <th>Qty</th>
                                        <th>Unit</th>
                                        <th>Rate</th>
                                        <th>Net Amount</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input type="text" class="form-control item-code" value="PROD001"></td>
                                        <td>
                                            <select class="form-select item-description">
                                                <option selected>Select Item</option>
                                                <option>Raw Material A</option>
                                                <option>Component B</option>
                                                <option>Finished Good C</option>
                                            </select>
                                        </td>
                                        <td><input type="number" class="form-control item-qty" value="1" min="1"></td>
                                        <td><input type="text" class="form-control item-unit" value="Pcs"></td>
                                        <td><input type="number" class="form-control item-rate" value="500" min="0"></td>
                                        <td><input type="number" class="form-control item-net-amount" readonly value="500"></td>
                                        <td>
                                            <button type="button" class="btn btn-danger btn-sm delete-row">Delete</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <button type="button" class="btn btn-outline-success btn-sm mt-2" id="addPurchaseItemButton"><i class="bi bi-plus-circle"></i> Add Item</button>
                    </fieldset>

                    <div class="row mb-3">
                        <div class="col-md-6 offset-md-6">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <strong>Total Quantity:</strong> <span id="purchaseTotalQuantity">0</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center fs-5 fw-bold ">
                                <span>Net Amount:</span> <span id="purchaseFinalNetAmount">0.00</span>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                        <button type="submit" class="btn btn-primary" id="submitPurchaseButton"><i class="bi bi-save"></i> Save Purchase</button>
                        <button type="button" class="btn btn-warning text-white" id="updatePurchaseButton" style="display: none;"><i class="bi bi-arrow-clockwise"></i> Update Purchase</button>
                        <button type="button" class="btn btn-secondary" id="printPurchaseFormButton"><i class="bi bi-printer"></i> Print Current Form</button>
                        <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#confirmClearPurchaseModal" id="clearPurchaseFormButton"><i class="bi bi-x-circle"></i> Clear Form</button>
                        <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exportOptionsModalPurchase" id="exportButtonPurchaseForm">
                            <i class="bi bi-share"></i> Export
                        </button>
                    </div>
                </form>
            </div>
            </div>

        <div id="purchaseListContainer" class="p-4 border rounded shadow-sm bg-light" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                       <button type="button" class="btn btn-outline-secondary" id="backToDashboardButtonPurchaseList">
                             <i class="bi bi-arrow-left-circle"></i> Back to Dashboard
                       </button>
                <h2 class="text-center flex-grow-1">Purchase List</h2>
                <div class="d-flex gap-2">
                    <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exportOptionsModalPurchase" id="exportButtonPurchaseList">
                        <i class="bi bi-share"></i> Export
                    </button>
                    <button type="button" class="btn btn-outline-info " id="purchaseListButtonBack"><i class="bi bi-plus-circle"></i> Back to Form</button>
                </div>
            </div>

            <div class="table-responsive">
                <table class="table table-striped table-bordered" id="purchaseListTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Date</th>
                            <th>Invoice No.</th>
                            <th>Supplier Name</th>
                            <th>Net Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="purchaseListTableBody">
                        </tbody>
                </table>
            </div>
            <p id="noPurchaseEntriesMessage" class="text-center text-muted mt-3" style="display: none;">No purchase entries yet.</p>
        </div>
    </div>

    <div class="modal fade" id="termsModalPurchase" tabindex="-1" aria-labelledby="termsModalLabelPurchase" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="termsModalLabelPurchase">Add New Term of Payment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" class="form-control" id="newTermInputPurchase" placeholder="e.g., Net 90, Installment">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="addTermButtonPurchase">Add Term</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmClearPurchaseModal" tabindex="-1" aria-labelledby="confirmClearPurchaseModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmClearPurchaseModalLabel">Confirm Clear Form</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Are you sure you want to clear all form fields? This action cannot be undone.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmClearPurchaseFormButton">Yes, Clear Form</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="exportOptionsModalPurchase" tabindex="-1" aria-labelledby="exportOptionsModalLabelPurchase" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="exportOptionsModalLabelPurchase"><i class="bi bi-share-fill"></i> Export Purchase Data</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center p-4">
                    <div class="d-grid gap-3">
                        <button type="button" class="btn btn-danger btn-lg" id="exportPurchasePdfButton"><i class="bi bi-file-earmark-pdf-fill"></i> Download PDF</button>
                        <button type="button" class="btn btn-success btn-lg" id="exportPurchaseExcelButton"><i class="bi bi-file-earmark-excel-fill"></i> Export to Excel</button>
                        <button type="button" class="btn btn-info btn-lg text-white" id="exportPurchaseEmailButton"><i class="bi bi-envelope-fill"></i> Export to Email</button>
                        <button type="button" class="btn btn-primary btn-lg" id="exportPurchaseWhatsappButton"><i class="bi bi-whatsapp"></i> Share via WhatsApp</button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="purchaseReturn.js"></script>
</body>
</html>
